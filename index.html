<!DOCTYPE HTML>
<html>
		<head>
    	<title>Jeremy Tavan's Security Blog</title>
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
		<meta name="viewport" content="width=device-width"> 
		<link href="/css/tufte.css" rel="stylesheet"  />
		<link href="/css/tufte-custom.css" rel="stylesheet" />
		<link href="/css/tufte-syntax.css" rel="stylesheet" />
		<link href="http://blog.jeremy.tavan.com/feed.xml" rel="alternate" type="application/rss+xml" title="Clutching at Security Blankets" />
	</head>	

<body>
				<a href="/"><h1>Clutching at Security Blankets</h1></a>
		<p class="subtitle">Lessons learned while working in Information Security.</p>
		<span class="codedirection">moc.navat@ymerej</span>
		<hr/>
		
			<section>
			<p><label for="mn-gs3kdodnpall" class="margin-toggle">&#8853;</label><input type="checkbox" id="mn-gs3kdodnpall" class="margin-toggle"/><span class="marginnote tags">Tags: <a href="/tag/security">security</a>&nbsp;<a href="/tag/linux">linux</a>&nbsp;</span></p>
			<h2><a href="/2016/08/13/Linux-Admins.html">What Makes a Linux Admin</a></h2> <br/>
			13 August 2016
			
			<p>I’m sorry if the title of this post sounds like I’m going to get all philosophical and start discussing the skills and personal characteristics that make someone a true Linux administrator. That’s not what this is about. Instead, it’s a lot more prosaic. If you’re using endpoint management software to track servers, and you want to audit the list of accounts with administrative privileges on a system, how do you do it?</p>

<p>In both Windows and MacOS, the definition of an “administrator” account is fairly easy. Under Windows, you look at the Administrators group. On MacOS there are a few ways to enumerate admins, but it all boils down to the users who have the “Allow user to administer this computer” checkbox checked.<label for="sn-dpjug8rs3vjz" class="margin-toggle sidenote-number"></label>
<input type="checkbox" id="sn-dpjug8rs3vjz" class="margin-toggle" /><span class="sidenote">Of course, as Unix systems, Macs also are subject to many of the criteria in the definition below. </span> Under Linux, things aren’t so straightforward. How would one define a Linux admin account for purposes of inventory and monitoring? I started thinking about this recently and came up with the following definition, which is definitely a work in progress:</p>

<p>An administrator of a Linux server is any user that meets any of the following definitions:<label for="sn-yb8mexmn7sc7" class="margin-toggle sidenote-number"></label>
<input type="checkbox" id="sn-yb8mexmn7sc7" class="margin-toggle" /><span class="sidenote">I know the oldschool UNIX admins are going to yell at me for the group names in (2). Sorry.</span></p>

<ol>
  <li>Is UID 0</li>
  <li>Is a member of the group <code>wheel</code> or <code>admin</code> or <code>administrators</code> or <code>root</code> 3. Exists in the sudoers file with an ALL permission line</li>
  <li>Exists in a group that exists in the sudoers file with an ALL permission line</li>
  <li>Exists in the <code>.k5login</code> file of any user account meeting any of criteria 1-4</li>
</ol>

<p>There are certainly other criteria which would be functionally equivalent to the above (for example, any user that can edit the sudoers file), but this seems like a good place to start for machines that are set up somewhat normally and not already compromised. I have BigFix relevance code for 1-4 on the list, which is complicated enough, and support for inspecting <code>/root/.k5login</code>, but haven’t yet implemented the full (5) successfully.</p>

			</section>
		
			<section>
			<p><label for="mn-kb9ecqxkznl6" class="margin-toggle">&#8853;</label><input type="checkbox" id="mn-kb9ecqxkznl6" class="margin-toggle"/><span class="marginnote tags">Tags: <a href="/tag/security">security</a>&nbsp;<a href="/tag/development">development</a>&nbsp;</span></p>
			<h2><a href="/2016/01/29/I-Figured-Out-The-Mystery.html">I figured out the mystery!</a></h2> <br/>
			29 January 2016
			
			<ol>
  <li>Find VB .NET source code, convert to step-by-step pseudocode.</li>
  <li>Reverse steps in the pseudocode.</li>
  <li>Generate RSA keypair.</li>
  <li>Build AES encryption tool using source above.</li>
  <li>Deliver encryption tool to secure workstation using management system.</li>
  <li>Invoke encryption tool, construct composite key.</li>
  <li>Encrypt private key.</li>
  <li>Embed private key in stored procedure in database on server.</li>
  <li>Update endpoint management scripts with public key.</li>
  <li>Test and verify functionality.</li>
  <li>(Most important) <strong>Document the hell out of everything.</strong></li>
</ol>

<p>It’s so simple!</p>

			</section>
		
			<section>
			<p><label for="mn-ayzeucabfidv" class="margin-toggle">&#8853;</label><input type="checkbox" id="mn-ayzeucabfidv" class="margin-toggle"/><span class="marginnote tags">Tags: <a href="/tag/organizations">organizations</a>&nbsp;<a href="/tag/humor">humor</a>&nbsp;</span></p>
			<h2><a href="/2015/11/09/Stages-of-Maturity.html">Stages of Maturity</a></h2> <br/>
			9 November 2015
			
			<ol>
  <li>We’re not a target.</li>
  <li>We’ve been breached - buy one of everything and fix it.</li>
  <li>What do we do with all this stuff?</li>
  <li>…</li>
  <li>Profit!</li>
</ol>

			</section>
		
	</article>
	<article>
		<p>
		
    <span class="previous">Previous</span>
  
  <span class="page_number">Page: 1 of 4</span>
  
    <a href="/page2" class="next">Next</a>
  
		</p>
	
</body>
</html>
